# Цифровая обработка сигналов

* [API: Концепции и Базовые принципы](Concepts.md)
* [API: Протокол управления и сбора данных](API.md)

<!--
```math
\mathrm{C}_{23} \in \mathcal{C} : \mathbb{C}
```
-->
## Базисные полиномы

_Базисные полиномы_. Нам нужно ввести понятие базисных полиномов, полиномы Бернштейна, Лагранжа, Эрмита, в частности. Нужно научиться получать разложения по выбранному базису полиномов. Целью разложения является поиск оптимального базиса, в котором удобно подбирать коэффициенты разложения. 

Интерполяция Лагранжа — это разложение по полиномам Лагранжа. Полиномы составляют базис, по которому раскладывается данная функция, т. е. данную функцию в этом базисе мы приближенно представляем, как линейную комбинацию — разложение по базисным функциям. 
```math
L_n(f;x) = \sum_{i=0}^n f(x_i) l_i(x); \quad 
l_i(x) = \prod_{\substack{j=0 \\  j \neq i}}^{N} {\frac{x-x_j}{x_i-x_j}}
```
где $f(x_i)$ - значения функции в точках $x_i$.
Разложение в ряд Тейлора - полиномы Тейлора.
```math
T_n(f;x) = \sum_{k=0}^n \frac{f^{(k)} (x_0) }{k!} (x - x_0)^k
```
при этом производные в дискретном пространстве будут представлены через конечные разности в точке $x_0$. На единичном интервале можно выбрать точку $x_{0}=0$ или $x_{0}=1$. 

Другой базис полиномов предложил российский математик Сергей Натанович Бернштейн[^3]. Базис ортогональных полиномов можно построить для любой степени на интервале $\left[0,1\right)$.
В общем виде базисные функции $\{ C_n^k x^k(1-x)^{(n-k)}\}_{k=0}^n$ для данной степени _n_ составляют полный набор, такой, что при любых $x \in [0,1]$ сумма базисных полиномов дает единицу — полиномы Бернштейна образуют _вероятностное пространство_. Полиномы выводятся из теории вероятностей, где аналогично вводится биномиальное распределение $C_n^k p^k q^{n-k}$ с вероятностью $p$ реализации события и вероятностью $q = (1-p)$ - дополнением.
```math
B(x) = \sum_{k=0}^{n} f(k/n) b_{k,n}(x); \quad\text{где} \quad b_{k,n}(x) = \binom{n}{k} x^k (1-x)^{n-k}
```
-- интерполяция базисными полиномами С.Н. Бернштейна.

Существуют и другие системы базисных полиномов, например, полиномы Пафнутия Львовича Чебышева. П.Л. Чебышев впервые ввел понятие ортогональных полиномов. 
- Полиномы Тейлора
- Полиномы Чебышева I и II рода (-1,+1).
- Полиномы Эрмита  
- Полиномы Ньютона
- Полиномы Бернштейна

Все начинается с изучения степенного ряда $\sum_{k=0}^n a_k x^k$ и приводится к степенному ряду. Все разложения по полиномам изоморфны между собой, ряд составленный из аналитических функций можно привести к степенному ряду. Аналитическая (голоморфная) функция — функция, которая может быть представлена степенным рядом.  

Нас интересует разложение операторов по базисным полиномам и полиномы составленные из операторов. Для этого вводится понятие оператор задержки и оператор сдвига при выборке данных из потока данных.

## Конечные разности

## Интерполяция сплайнами 

### Базовый сплайн (B-сплайн)

Базовый сплайн задается на интервале $\left[0,1\right)$  и обобщает интерполяцию полиномами Бернштейна. Сплайны мы рассматриваем в виде последовательности разложения с повышением степени полиномов.
B-сплайны могут быть вычислены с помощью рекурсивного алгоритма Кокса — де Бура, (обобщающего алгоритм де Кастельжо [^1] [^2]): 
-- B-сплайн как и в случае интерполяции Лагранжа проходит через узловые точки.
-- сплайн нулевого порядка =1 на интервале и =0 вне интервала.
-- рекурсивное построение
-- результат для степени (p) и числа точек k. 

#### Алгоритм де Бура

Позволяет разложить B-сплайн в каскад сплайнов первого порядка. Новый набор контрольных точек вычисляется через первоначальный рекурсивно для каждого уровня разложения. 


## Проектирование Фильтров 

Проектирование в S-пространстве 
```math
HP(s) = \frac{1}{s^2+\frac{\omega_0}{Q_0} s+\omega_0^2}
```
При замене переменных 
$$s = \frac{2}{T_s} \frac{1-z^{-1}}{1+z^{-1}}$$
Возникает разложение операторов по полиномам 
$$\frac{1}{2^{n-k} T_s^k}(1-z^{-1})^k(1+z^{-1})^{n-k}$$
<!-- _Как это выводится_. Я беру за основу полиномы Бернштейна, которые получены для вероятностей. Вероятности p и q должны рассчитываться в один момент времени. Если $q = (1-z^{-1})$ - мы считаем разницу $x_k$ и $x_{k-1}$. Это - конечная разница в точке $(x_k + x_{k-1})/2$ 

Поэтому базисные полиномы из биномиального распределения следует переписать таким образом:
```math
g_{k,n} = C_n^k (1-x)^k \left(\frac{1+x}{2}\right)^{n-k}
```
-->
Цифровые фильтры вводятся через соотношения величин $F_c$ - частота среза, $F_s$ - частота дискретизации, $Q$ - добротность фильтра на частоте среза. $K = \tan(\pi F_c/F_s)$ 
$$a_1 = K^2 ,\quad a_3 = K/Q$$


Фильтры highpass, lowpass, bandpass можно переписать в операторной форме:
```math
HP(z) = \frac{(1-z^{-1})^2}{(1-z^{-1})^2 + a_1(1+z^{-1})^2 + a_3 (1- z^{-2})}
```
```math
LP(z) = \frac{a_1(1+z^{-1})^2}{(1-z^{-1})^2 + a_1(1+z^{-1})^2 + a_3 (1- z^{-2})}
```
```math
BP(z) = \frac{a_3(1-z^{-2})}{(1-z^{-1})^2 + a_1(1+z^{-1})^2 + a_3 (1- z^{-2})}
```
Видно, что разложение может быть выполнено по базису полиномов $(1-z^{-1})^2$, $(1+z^{-1})^2$, $(1-z^{-2})$
в нем фильтры HP, LP, BP оказываются ортогональными, т.е любой фильтр можно представить, как их линейную комбинацию. Причем $HP(z)+LP(z)+BP(z)=1$

Фильтры Баттерворта высоких порядков в S-пространстве вводятся 
```math
H(s) = \frac{1}{\prod_{k=1}^{n/2} \left(s^2 + 2 \sin(\theta_k) \beta s + \beta^2 \right) }, 
\text{где}\quad \theta_k = \frac{2 k -1 }{2n}\pi, \text{для четных n} 
```
```math
H(s) = \frac{1}{(s+\beta)\prod_{k=1}^{(n-1)/2} \left(s^2 + 2 \sin(\theta_k) \beta s + \beta^2 \right) }, 
\text{для нечетных n} 
```
На практике обычно используют фильтры четных порядков. Фильтры в Z-пространстве будут представлены каскадом секций второго порядка (SOS). 

Полиномы можем выбрать в одном из трех базисов, соответствующих начальным, конечным и центральным разностям или в степенном базисе.
Естественным является базис
$$\{ (1-z^{-1})^k(1+z^{-1})^{n-k} \}_{k=0}^n$$

## PID-регуляторы

Передаточная функция регулятора состоит их трех компонент $P+I+D$, пропорциональной интегральной и дифференциальной, с общим коэффициентом усиления:
```math
C(s) = P(s)+I(s)+D(s) = K_p\left(1+\frac{1}{T_i \cdot s} + T_d D(s)\right)
```
Для перехода в Z- пространство используется подстановка
$$s= \frac{2}{T_s} \frac{1-z^{-1}}{1+z^{-1}},$$
где $T_s$ – период дискретизации. 
```math
C(z) = g ( \bar{\beta_1} P(z)+\beta_1 I(z)(\bar{\beta_2}+\beta_2 D(z)) )
```
передаточные функции компонент представлены в операторной форме:
```math
P(z) = (1-z^{-1});\quad I(z) = (1+z^{-1})/2;\quad D(z) = (1-z^{-1})^2 LPF(z).
```
Фильтр $D(z)$ применяется к усредненному значению параметра, $LPF(z)$ - фильтр нижних частот (сокр. Low-Pass Filter). 


```math
C(z) = g \left( \bar{\beta_1}+ \beta_1 \left( \bar{\beta_2} L_1(z) + \beta_2 (1-z^{-1}) L_{\alpha}(z) \right) \right)
```
где $L_1(z)$ и $L_{\alpha}(z)$ - фильтры нижних частот с передаточной функцией: 
```math 
L_1(z) = \frac{1}{2} \frac{1+z^{-1}}{1-z^{-1}} ;\quad
  L_\alpha(z) = \frac{1}{2} \frac{\bar{\alpha}(1+z)}{1-\alpha z^{-1}}
```

## Конформные отображения


* [LaTeX.math] <https://en.wikibooks.org/wiki/LaTeX/Mathematics>
* [DSP.dsplib] <https://ru.dsplib.org/>