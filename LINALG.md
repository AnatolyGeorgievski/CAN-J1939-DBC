# Разложение матриц и решение СЛАУ #

**СЛАУ** - системы линейных алгебраических уравнений

Системы уравнений возникают при численном решении систем дифференциальных уравнений в конечных разностях. В этом случае используются методы численного решения для сильно разряженных и ленточных матриц. 

В приложении Аффинных (обратимых) преобразований необходимо находить обратную матрицу. 

Матрицы или линейные формы образуются на множестве вещественных $\mathbb{R}$ или множестве комплексных чисел $\mathbb{C}$. Как правило, методы решения СЛАУ реализованные на множестве комплексных чисел легко переносятся на множество вещественных чисел, но наоборот теряются операции сопряжения. 
Матрицы применяются в сочетании с понятием вектор, а вектора возникают при разложении по базису. Переход между базисами (системами координат или наборами ортогональных функций) - это матрицы. 

Линейная алгебра - это алгебра абстрактная, которая оперирует множеством матриц и операциями: сложения, умножения и умножения матрицы на скаляр. Операция умножения матриц не являются коммутативной. По отношению к операции умножения существует обратные матрицы, произведение матрицы на обратную дает инвариант - единичную диагональную матрицу.  

Линейную алгебру надо изучать на примерах и реализовывать численные методы. 
Без практики и прикладных задач - это кажется бессмысленным. 

Решение СЛАУ требует большого числа операций. Решение может быть получено за один проход по строкам матрицы в особых случаях - матрицы треугольные. Если на диагонали матрицы единицы то исключается операция деления. По этой причине разложение матриц на произведение диагональных и треугольных матриц - это способ снизить сложность расчетов. Для сильно разреженных матриц применяется перестановка строк, чтобы матрицы стали диагональные. Перестановка строк может привести матрицу к блочно-диагональному виду - это тоже удобный метод снижения сложности расчетов, который позволяет выполнять расчеты блоками меньшей размерности. 

## Основные определения

**Диагональная матрица** — квадратная матрица, все элементы которой, стоящие вне главной диагонали, равны нулю.

**Треуго́льная ма́трица** — квадратная матрица, у которой все элементы, стоящие ниже (или выше) главной диагонали, равны нулю.

**Унитреугольная матрица** - треугольная матрица (верхняя или нижняя), в которой все элементы на главной диагонали равны единице.

**Унитарная матрица** - это квадратная матрица, в общем случае состоящая из
комплексных чисел, произведение которой на эрмитово-сопряженную матрицу
равно единичной матрице, т.е.:
$$U^* U = U U^* = I$$

**Ортогональная матрица** - это унитарная матрица, но только с вещественными
числами, для которой справедливо:
$$A^T A = A A^T = I ,$$
и как следствие: $A^T = A^{−1}$

**Эрмитова матрица** - это квадратная матрица, в общем случае состоящая из 
комплексных чисел, которая равна своей эрмитово-сопряженной (сопряженно-
транспонированной матрице) и равна транспонированной комплексно-сопряженной
матрице, т.е.:
$$A = (\bar{A})^T = A^*,$$
$A^*$ -- это и транспонирование и поэлементное комплексное сопряжение

## Математические классы

Математические структуры (,,,) задаются перечислением множеств и их отношением.

Математические классы - понятие вводится в курсе анализа [1] и близко к определениям классов в ООП. Базовым понятием являются множества - абстрактные типы данных и алгебра абстрактная (общая) над множествами с переопределением операций типа сложения и умножения, и обратными числами. А также вводятся абстрактные методы принимающие тип от элемента множества, к которому они применяются - лямбда функции и лямбда выражения. В таком виде множества вводятся в математической логике. Кроме того вводится функциональный и императивный способ записи выражений математического языка.

В курсе анализа вводятся сигма-алгебра множеств, которой сопоставляется алгебра над множеством вещественных чисел - операции с мерой (плотностью) множества.

Абстрактная алгебра множеств включает операции пересечения, объединения и дополнения до целого. Сигма-алгебра сопоставляет им операции сложения, вычитания и обращения чисел (дополнения до инварианта). Сигма-алгебра определяется для непересекающихся элементов разбиения множества. Множества могут быть упорядоченными, если можно ввести функцию сравнения. Множества могут быть измеримые. 

Понятие пространство вводится, как тройка математическая структура состоящая из трех элементов: множества, разбиения (разложение по выбранному базису) и меры. Мера- обобщающее понятие от объема, площади, массы, плотности элементов разбиения. 

Связанные понятия:
Измеримые пространства, Вероятностное пространство, Метрические пространства, Нормируемые пространства, Линейное пространство, Векторное пространство, Аффинные пространства, Евклидово пространство, Гильбертово пространство, пространство суммируемых функций... 

**Метри́ческое простра́нство** — множество вместе со способом измерения расстояния между его элементами. 
Пара $(M,\;d)$, состоящая из множества $M$ и функции 
$d: M\times M\to \mathbb{R} $ из его декартова квадрата в множество вещественных чисел, называется метрическим пространством, если выполняется ряд аксиом:
1. $d(x,y)=0\Leftrightarrow x=y$ (аксиома тождества);
2. $d(x,y)\geqslant 0$ (аксиома положительности);
3. $d(x,y)=d(y,x)$ (аксиома симметричности);
4. $d(x,z)\leqslant d(x,y)+d(y,z)$ (неравенство треугольника).

Этот класс экспортирует метод `distance(M a, M b)` для любой пары элементов множества $M$.

**Векторное пространство** 
Вектора определены над _полем_ комплексных чисел или вещественных чисел (в общем случае любым, включая рациональные числа, конечные числа), с заданной операцией сложения векторов и операцией умножения на скаляр. 

Этот класс определяет два множества: множество векторов и множество скаляров. 

Свойство линейности определяется через восемь аксиом..
1. $\mathbf{x} +\mathbf{y} =\mathbf{y} +\mathbf{x}$ для любых 
$\mathbf{x} ,\mathbf{y} \in V$ (коммутативность сложения);
2. $\mathbf{x} +(\mathbf{y} +\mathbf{z})=(\mathbf{x} +\mathbf{y})+\mathbf{z} $ для любых 
$\mathbf{x} ,\mathbf {y} ,\mathbf {z} \in V$ (ассоциативность сложения);
3. существует обратный элемент $\mathbf{0} \in V$, что 
$\mathbf{x} +\mathbf {0} =\mathbf {0} +\mathbf {x} =\mathbf {x} $ для любого 
$\mathbf{x} \in V$ (существование нейтрального элемента относительно сложения);
4. для любого $\mathbf{x} \in V$ существует такой элемент 
$-\mathbf {x} \in V$, что 
$\mathbf {x} +(-\mathbf {x} )=\mathbf {0}$, называемый вектором, противоположным вектору $\mathbf{x}$;
6. $\alpha (\beta \mathbf{x} )=(\alpha \beta )\mathbf{x} $ (ассоциативность умножения на скаляр);
6. $1\cdot \mathbf{x} =\mathbf{x}$ (унитарность: умножение на нейтральный элемент поля $F$).
7. $(\alpha +\beta )\mathbf{x} =\alpha \mathbf{x} +\beta \mathbf{x}$ (дистрибутивность умножения вектора на скаляр относительно сложения скаляров);
8. $\alpha (\mathbf{x} +\mathbf{y} )=\alpha \mathbf{x} +\alpha \mathbf{y} $ (дистрибутивность умножения вектора на скаляр относительно сложения векторов).

Вектор - это коэффициенты разложения по данному базису. Полиномы, например, определяют вектор коэффициентов по степенному базису. Но отдельно дается метод расчета полинома, который рассчитывает значения базисных функций для данного параметра с учетом коэффициентов разложения. В этом случае говорят про линейное пространство суммируемых функций. В многомерном пространстве, когда функции зависят более чем от одного переменного, возникает пространство квадратично-суммируемых функций. 

**Нормируемое пространство** — векторное пространство с заданной на нём нормой

Нормированным пространством называется математическая структура $(V,\|\cdot \|)$ из векторного пространства $V$ над _полем_ действительных или комплексных чисел и отображения 
$\|\cdot \|: X\to \mathbb{R}$ таких, что выполняются следующие свойства для любых 
$x,y\in V$ и скаляра $\lambda$:
1. $\|x\|\geqslant 0,\;\|x\|=0\Rightarrow x=0$ (положительная определённость)
2. $\|\lambda x\|=|\lambda |\cdot \|x\|$ (однородность)
3. $\|x+y\|\leqslant \|x\|+\|y\|$ (неравенство треугольника) 

Норма -- обобщенное понятие длины вектора.

Если определена норма, метрику можно определить через норму $d(x,y)=\|x-y\|$.

Класс экспортирует функцию `norm(V a)` и `distance(V a, V b)`

**Евклидово пространство**
Конечномерное вещественное векторное пространство $\mathbb{R}^{n}$ с введённым на нём положительно определённым скалярным произведением.

Скалярное произведение `dot(V a, V b)` (dot product) может порождать метрику и норму вектора. А также используется для вычисления углов между векторами и для определения ортогональности векторов. 

**Унитарное пространство** - векторное пространство над полем комплексных чисел  $\mathbb{C}^{n}$ с положительно определенным эрмитовым скалярным произведением.


**Аффи́нное простра́нство** — математическая структура над векторным пространством, дополняет евклидову геометрию матрицей аффинного (обратимого) преобразования. Аффинное пространство оперирует с объектами двух типов: «векторами» и «точками». Матрицы аффинного преобразования подчиняются своей алгебре, определены операции наложения матриц и обращения. Координаты точек задают вектора единственным образом. 

Не пустое множество $\mathbb{A} \neq \emptyset$ называется аффинным пространством над векторным пространством $V$, если задано отображение, сопоставляющее любой упорядоченной паре точек из $A$ некоторый вектор из $V$ $g: A \times A \to V$ и удовлетворяющее двум аксиомам (аксиомы Вейля)
1. Для любой точки $\forall A \in \mathbb{A}$ и любого вектора $\forall \vec{a} \in V$ существует единственная точка $\forall B \in \mathbb{A}$, для которой $g(A,B) = \vec{a}$.\
(далее будем обозначать $g(A,B)=\vec{AB}$)
2. Для любых трех точек $\forall A,B,C \in \mathbb{A}$ имеет место равенство $\vec{AB}+\vec{BC}=\vec{AC}$

Заметим, что аффинное пространство определяет множества точек, и отображение в векторное пространство. 

**Ги́льбертово простра́нство** — обобщение евклидова пространства, допускающее бесконечную размерность и _полное_ по метрике, порождённой скалярным произведением. 

## LU- разложение матриц и решение систем СЛАУ методом LU ##

Методы вычисления LU-разложения:
- метод Гаусса;\
(низкая точность для разреженных матриц, большой объем вычислений)
- алгоритм Дулиттла;\
(L - унитреугольная, U - верхняя треугольная)
- алгоритм Кроута.\
(L - нижняя треугольная, U - унитреугольная)

*LUP*-разложение (LUP-декомпозиция) — представление данной матрицы 
𝐴 в виде произведения $P A = L U$ где матрица 
𝐿 является нижнетреугольной с единицами на главной диагонали, 
𝑈 — верхнетреугольная общего вида, а 𝑃 — т. н. матрица перестановок, 
получаемая из единичной матрицы путём перестановки строк или столбцов. 

*LUP*-разложение это LU-разложения матрицы A с частичным выбором ведущего
элемента (перестановка по строкам), которое записывается следующим образом:
$$P A = L U ,$$
а в случае перестановок по столбцам LUP-разложение записывается в виде:
$$A Q = L U ,$$
а, в наиболее общем виде:
$$P A Q = L U ,$$
где:\
$P$ - матрица перестановок по строкам;\
$Q$ - матрица перестановок по столбцам;\
$L$ - нижняя унитреугольная матрица;\
$U$ - верхняя треугольная матрица.

*LDU*-разложение матрицы A - это ее представление в виде произведения трех
матриц:
$$A = L D U ,$$
где:\
$D$ - диагональная матрица;\
$L$ - нижняя унитреугольная матрица;\
$U$ - верхняя унитреугольная матрица.

*LL* - разложение (Разложение Холецкого)
LL-разложение положительно определенной матрицы A - это ее представление в
виде произведений двух матриц:
$$A = L L^* \quad A = U^* U$$
где:\
$L$ - нижняя треугольная матрица; \
$U$ - верхняя треугольная матрица.

Для вещественных матриц операция сопряжения заменяется на транспонирование: $L^* = L^T$ и $U^* = U^T$.

Существует несколько алгоритмов получения разложения Холецкого:
- классический алгоритм Холецкого;
(в его основе метод исключения Гаусса при приведении исходной матрицы к нижнетреугольному виду)
- алгоритм Холецкого-Банахевича;\
(алгоритм вычисления матрицы L начиная с первой строки и далее итерационно по каждой строке)
- алгоритм Холецкого-Кроута;\
(алгоритм вычисления матрицы U начиная с первого столбца и далее итерационно по каждому столбцу)

Алгоритм Кроута в обобщенном виде является алгоритмом вычисления LU-разложения,
где $L$ - нижняя треугольная, а $U$ - унитарная верхняя треугольная.


*QR* - разложение матрицы — представление матрицы в виде произведения унитарной 
(или ортогональной матрицы) и верхнетреугольной матрицы. QR-разложение является 
основой одного из методов поиска собственных векторов и чисел матрицы — QR-алгоритма

### Процесс Грама-Шмидта
Процесс Грама-Шмидта — это метод вычисления ортогональной матрицы Q, которая состоит из ортогональных или независимых единичных векторов и занимает такое же пространство, что и матрица X.

1. Выбрать вектор столбец u_1 = x_1, x_1!=0
2. Расчитать для всех столбцов u_k = x_k - sum_{j=1}^{k-1} proj(u_j, x_k)
3. Для всех векторов Q_k = u_k/ norm(u_k) -- нормализация

proj - считает ортогональный вектор u_k к другим методом найти такую константу чтобы u_2 = x_2 - c u_2
```math
QR = X \\
R = Q^-1 X = Q^T X
```

<https://www-users.cse.umn.edu/~olver/aims_/qr.pdf>

### Спектральное разложение матрицы

Спектральное разложение матрицы A - это ее представление в виде произведения трех матриц:
$$A = V \Lambda V^{−1},$$
где:\
$V$ - матрица с собственными векторами матрицы $A$;\
$\Lambda$ - диагональная матрица с собственными значениями $\lambda(A)$.
Только матрицы, имеющие полный набор собственных значений, могут быть представлены в виде спектрального разложения.

### Каноническая форма Жордана

Каноническая форма Жордана - это представление квадратной матрицы A в виде:
$$A = C J C^{−1},$$
где:\
$C$ - матрица перехода к новому базису;\
$J$ - матрица Жордана.

По сути, это разложение - обобщение спектрального разложения на случай кратных собственных значений.
Если кратность всех собственных значений матрицы A равна единице, то матрица
J - диагональная. В противном случае матрица J является блок-диагональной и
состоит из Жордановых блоков.

### Разложение Шура

Разложение Шура матрицы A - это ее представление в виде произведения трех матриц:
$$A = U T U^*,$$
где:\
$U$ - унитарная матрица;\
$U^*$- эрмитово-сопряженная матрица;\
$T$ - верхняя треугольная матрица с собственными значениями на диагонали $T_{i,i} = 𝜆_i(A)$.

Для случая вещественных чисел разложение имеет вид:
$$A = V T V^T ,$$
где:\
$V$ - ортогональная матрица.

### Определитель матрицы
```math
	det(Aᵀ)= det(A) \\
	det(A)=det(LU)=det(L)\cdot det(U)
```
Определитель, вычисленный $det(A)$ мера масштабного коэффициента линейного преобразования, 
описанного матрицей. Когда определитель ниже нуля, матрица сингулярна, и никакая инверсия не существует.

Определитель треугольной матрицы - произведение диагональных элементов. 

Некоторые матрицы почти сингулярны, и несмотря на то, что обратная матрица существует, 
вычисление восприимчиво к числовым ошибкам. $cond(A)$ функция вычисляет число обусловленности 
для инверсии, которая дает индикацию относительно точности результатов матричной инверсии. 
Число обусловленности лежит в диапазоне от 1 для численно устойчивой матрицы к $\infty$ для 
сингулярной матрицы.


### Дополнительный минор

Дополнительный минор $M¯_{i,j}$ квадратной матрицы A - это определитель, 
составленный из элементов матрицы A путем удаления строк и столбцов c номерами ${i,j}$

### След матрицы

След матрицы $tr(A)$ - это скалярное значение, которое
равно сумме всех диагональных элементов этой матрицы
След матрицы равен сумме ее собственных значений


### Собственные вектора и собственные значения матрицы

Собственным вектором x и соответствующим ему собственном значением 𝜆 
матрицы A называются величины, для которых следующее равенство имеет 
ненулевое решение:
$$A v = \lambda v$$

В общем случае определение собственных значений и собственных векторов 
требует решения матричного уравнения:
$$(A − \lambda I) v = 0 ,$$

Матрица комплексная может быть разложена на произведение 
$$A = U R U^*,$$
где:\
$R$ - Треугольной матрицы, содержащей собственные значения на главной диагонали\
$U$ - унитарная матрица $U* = U^{-1}$\
$U^*$ - транспонированная комплексно-сопряженная матрица 

Если $A$ - нормальная, то $AA^* = A^*A$, то матрица R- диагональная содержит собственные значения

Если $A$ - нормальная Эрмитова матрица, то собственные значения - вещественные числа. 

Методы в Mathlab и GNU Octave:
- eig  - спектральное разложение;
- eigs - собственные значения и собственные вектора матрицы;
- svd  - сингулярное разложение;
- svds - сингулярные значения и сингулярные вектора матрицы;
- lu   - LU-разложение, LUP-разложение;
- chol - LL-разложение;
- ldl  - LDL-разложение;
- schur- разложение Шура;
- qr   - QR-разложение;


Отдельно рассмотрим матрицы трехдиагональные и методы решения таких задач

Трехдиагональные (ленточные) матрицы возникают из записи системы уравнений
в конечных разностях (по сетке), в частности при численном решении 
уравнений теплопроводности

Метод прогонки для трех-диагональных матриц. 
Матрицы записываются через три вектора. 
```
A B C = F
[B0 C0 .  .  . ]   F0
[A1 B1 C1 .  . ]   F1
[.  A2 B2 C2 . ]y= F2
[.  .  A3 B3 C3]   F3
[.  .  .  A4 B4]   F4
```

Алгоритм:
1) a[0] := -C0/B0, b[0] := F0/B0
2) Для k = 1 ... n
   d  = (Ak*a[k-1]+Bk)
   a[k] := -Ck/d
   b[k] := (Fk-Ak*b[k-1])/d
3) y[n]: = (Fn-An*b[n])/(An*a[n] + Bn)
4) Для k = n-1 ... 0
   y[k]  = a[k]*y[k+1]+b[k]

По ходу разложения можно найти детерминант трехдиагональной матрицы
det(A) = prod_{i=0}^{n}(Ai*a[i]-Bi)
* Алгоритм надо дорабатывать см Калиткин

Метод покоординатной расщепления:
Решение двумерной задачи может быть представлено покоординатно.
На каждом шаге решается методом прогонки.




Построение обратной матрицы 2x2 или 3x3: A^{-1} = adj(A) / det(A)
adj(Ф) - присоединенная составленная из алгебраических дополнений для элементов транспонированной матрицы

<https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D1%80%D0%B0%D1%82%D0%BD%D0%B0%D1%8F_%D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%86%D0%B0>
